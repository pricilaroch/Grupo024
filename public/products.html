<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Meus Produtos - Sistema de Gestão de Encomendas</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>
  <nav id="navbar" class="navbar"></nav>

  <div class="container container-wide">
    <main class="main-content">

      <!-- Page header -->
      <div class="products-header">
        <div>
          <h1 class="products-title">Meus Produtos</h1>
          <p class="products-subtitle">Gerencie seu catálogo e acompanhe suas margens.</p>
        </div>
        <button id="btnNewProduct" class="btn btn-primary">+ Novo Produto</button>
      </div>

      <!-- Filter bar -->
      <div class="products-filter-bar">
        <div class="products-filter-tabs">
          <button class="filter-tab active" data-filter="all">Todos</button>
          <button class="filter-tab" data-filter="active">Ativos</button>
          <button class="filter-tab" data-filter="inactive">Inativos</button>
        </div>
        <span id="productCount" class="products-count"></span>
      </div>

      <!-- Product cards grid -->
      <div id="productsGrid" class="products-grid">
        <!-- Cards are rendered by JS -->
      </div>

      <!-- Empty state -->
      <div id="emptyState" class="products-empty" style="display:none;">
        <div class="products-empty-icon" aria-hidden="true">&#128230;</div>
        <h2>Nenhum produto cadastrado</h2>
        <p>Comece adicionando seus produtos para organizar seu catálogo e acompanhar seus lucros.</p>
        <button id="btnEmptyNew" class="btn btn-primary">+ Cadastrar primeiro produto</button>
      </div>

      <!-- Loading state -->
      <div id="loadingState" class="admin-loading">Carregando produtos…</div>

    </main>
  </div>

  <!-- ═══════════════════════════════════════════════════
       Modal: Criar / Editar Produto
       ═══════════════════════════════════════════════════ -->
  <div id="productModal" class="modal-overlay" style="display:none;">
    <div class="modal modal-product">
      <h3 id="modalTitle">Novo Produto</h3>
      <p id="modalSubtitle" class="modal-user-name">Preencha os dados do produto.</p>

      <form id="productForm" novalidate>
        <div id="formAlert" class="alert alert-error" style="display:none;"></div>

        <!-- Nome -->
        <div class="form-group">
          <label for="f-nome">Nome *</label>
          <input type="text" id="f-nome" name="nome" placeholder="Ex: Bolo de Chocolate" autocomplete="off">
          <span class="field-error" data-for="nome"></span>
        </div>

        <!-- Descrição -->
        <div class="form-group">
          <label for="f-descricao">Descrição *</label>
          <textarea id="f-descricao" name="descricao" placeholder="Descrição do produto" rows="3"></textarea>
          <span class="field-error" data-for="descricao"></span>
        </div>

        <!-- Preços lado a lado -->
        <div class="form-row">
          <div class="form-group form-group-half">
            <label for="f-preco_venda">Preço de Venda (R$) *</label>
            <input type="number" id="f-preco_venda" name="preco_venda" step="0.01" min="0" placeholder="0,00">
            <span class="field-error" data-for="preco_venda"></span>
          </div>
          <div class="form-group form-group-half">
            <label for="f-preco_custo">Preço de Custo (R$)</label>
            <input type="number" id="f-preco_custo" name="preco_custo" step="0.01" min="0" placeholder="0,00">
            <span class="field-error" data-for="preco_custo"></span>
          </div>
        </div>

        <!-- Lucro preview -->
        <div id="profitPreview" class="profit-preview" style="display:none;">
          <div class="profit-preview-row">
            <span class="profit-preview-label">Lucro estimado</span>
            <span id="profitValue" class="profit-preview-value">R$ 0,00</span>
          </div>
          <div class="profit-preview-row">
            <span class="profit-preview-label">Margem</span>
            <span id="marginValue" class="profit-preview-margin">0%</span>
          </div>
        </div>

        <!-- Categoria e Unidade -->
        <div class="form-row">
          <div class="form-group form-group-half">
            <label for="f-categoria">Categoria *</label>
            <input type="text" id="f-categoria" name="categoria" placeholder="Ex: Doces">
            <span class="field-error" data-for="categoria"></span>
          </div>
          <div class="form-group form-group-half">
            <label for="f-unidade_medida">Unidade de Medida</label>
            <input type="text" id="f-unidade_medida" name="unidade_medida" placeholder="Ex: unidade, kg">
            <span class="field-error" data-for="unidade_medida"></span>
          </div>
        </div>

        <!-- Estoque e Tempo -->
        <div class="form-row">
          <div class="form-group form-group-half">
            <label for="f-quantidade_estoque">Estoque</label>
            <input type="number" id="f-quantidade_estoque" name="quantidade_estoque" min="0" step="1" placeholder="0">
            <span class="field-error" data-for="quantidade_estoque"></span>
          </div>
          <div class="form-group form-group-half">
            <label for="f-tempo_producao_minutos">Tempo de Produção (min)</label>
            <input type="number" id="f-tempo_producao_minutos" name="tempo_producao_minutos" min="0" step="1" placeholder="0">
            <span class="field-error" data-for="tempo_producao_minutos"></span>
          </div>
        </div>

        <!-- Imagem URL -->
        <div class="form-group">
          <label for="f-imagem_url">URL da Imagem</label>
          <input type="url" id="f-imagem_url" name="imagem_url" placeholder="https://exemplo.com/foto.jpg">
          <span class="field-error" data-for="imagem_url"></span>
        </div>

        <!-- Actions -->
        <div class="modal-actions">
          <button type="button" id="btnCancelModal" class="btn btn-secondary">Cancelar</button>
          <button type="submit" id="btnSubmit" class="btn btn-primary">Salvar Produto</button>
        </div>
      </form>
    </div>
  </div>

  <!-- ═══════════════════════════════════════════════════
       Modal: Confirmar Exclusão
       ═══════════════════════════════════════════════════ -->
  <div id="deleteModal" class="modal-overlay" style="display:none;">
    <div class="modal">
      <h3>Excluir Produto</h3>
      <p class="modal-user-name">Tem certeza que deseja excluir <strong id="deleteProductName"></strong>? Esta ação não pode ser desfeita.</p>
      <div class="modal-actions">
        <button type="button" id="btnCancelDelete" class="btn btn-secondary">Cancelar</button>
        <button type="button" id="btnConfirmDelete" class="btn btn-danger">Excluir</button>
      </div>
    </div>
  </div>

  <script src="/js/services/api.js"></script>
  <script src="/js/services/guard.js"></script>
  <script src="/js/products.js"></script>
</body>
</html>
